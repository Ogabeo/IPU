{% extends "base.html" %}
{% load static %}

{% block title %}
{{ muayyan_ilmiy_yangilik.title }}
{% endblock title %}

{% block extrahead %}
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/glightbox/dist/css/glightbox.min.css">
<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css">

<!-- Bootstrap 4 CSS (kerak bo‘lsa) -->
<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css">

<style>
    .carousel-item img {
        max-height: 550px;
        object-fit: cover;
        border-radius: 25px;
    }
</style>
{% endblock extrahead %}

{% block context %}
<div class="max-w-6xl mx-auto mt-16 px-4">

    <!-- ASOSIY YANGILIK -->
    <div class="text-center mb-12">
        {% with birinchi_rasm=muayyan_ilmiy_yangilik.rasmlar.first %}
            {% if birinchi_rasm %}
                <a href="{{ birinchi_rasm.image.url }}" 
                   class="glightbox"
                   data-gallery="yangilik-gallery">
                    <img src="{{ birinchi_rasm.image.url }}" 
                         class="w-full max-h-[600px] object-cover rounded-3xl shadow-2xl mb-8 cursor-pointer">
                </a>
            {% endif %}
        {% endwith %}

        <h1 class="text-5xl font-bold text-blue-900 mb-6">
            {{ muayyan_ilmiy_yangilik.title }}
        </h1>

        <p class="text-lg text-gray-700 leading-relaxed">
            {{ muayyan_ilmiy_yangilik.description }}
        </p>

        <p class="text-gray-500 mt-4">{{ muayyan_ilmiy_yangilik.created_at }}</p>
    </div>

    <!-- CAROUSEL -->
   {% if muayyan_xalqaro_yangilik.rasmlar.all %}
    <div class="mt-20">
        <h2 class="text-3xl font-semibold text-center text-blue-900 mb-10">
            Ushbu yangilikka oid barcha rasmlar
        </h2>

        <div id="yangilikCarousel" class="carousel slide" data-ride="carousel" data-interval="false">

            <!-- Indicators -->
            <ol class="carousel-indicators">
                {% for rasm in muayyan_xalqaro_yangilik.rasmlar.all %}
                <li data-target="#yangilikCarousel"
                    data-slide-to="{{ forloop.counter0 }}"
                    class="{% if forloop.first %}active{% endif %}">
                </li>
                {% endfor %}
            </ol>

            <!-- Slides -->
            <div class="carousel-inner">
                {% for rasm in muayyan_xalqaro_yangilik.rasmlar.all %}
                <div class="carousel-item {% if forloop.first %}active{% endif %}">

                    <a href="{{ rasm.image.url }}"
                       class="glightbox"
                       data-gallery="yangilik-gallery">
                        <img src="{{ rasm.image.url }}"
                             class="d-block w-100"
                             style="max-height:550px; object-fit:cover; cursor:pointer;">
                    </a>

                </div>
                {% endfor %}
            </div>

            <!-- Controls -->
            <a class="carousel-control-prev" href="#yangilikCarousel" role="button" data-slide="prev">
                <span class="carousel-control-prev-icon"></span>
            </a>

            <a class="carousel-control-next" href="#yangilikCarousel" role="button" data-slide="next">
                <span class="carousel-control-next-icon"></span>
            </a>

        </div>
    </div>
    {% endif %}

</div>
{% endblock context %}

{% block static %}

<!-- jQuery (FULL) -->
<script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>

<!-- Popper + Bootstrap -->
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js"></script>

<script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js"></script>

<script src="https://cdn.jsdelivr.net/npm/glightbox/dist/js/glightbox.min.js"></script>

<script>
    const lightbox = GLightbox({
        touchNavigation: true,
        loop: true,
        zoomable: true,
        draggable: true,
        openEffect: 'zoom',
        closeEffect: 'fade'
    });

    // Carousel to‘liq ishga tushishi uchun
    $('#yangilikCarousel').carousel({
        interval: false,
        ride: "carousel"
    });
</script>

{% endblock static %}
